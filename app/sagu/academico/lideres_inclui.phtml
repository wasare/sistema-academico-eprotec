<? require("../../../lib/common.php"); ?>
<? require("../../../lib/config.php"); ?>
<? require("../lib/SQLCombo.php3"); ?>
<?
   $op1_opcoes = SQLArray($sql_periodos_academico);
?>
<html>
<head>
<script language="JavaScript">

function ChangeOption(opt,fld)
{
  var i = opt.selectedIndex;

  if ( i != -1 )
    fld.value = opt.options[i].value;
  else
    fld.value = '';
}

function ChangeOp1()
{
  ChangeOption(document.myform.op1,document.myform.ref_periodo);
}

function ChangeCode(fld_name,op_name)
{ 
  var field = eval('document.myform.' + fld_name);
  var combo = eval('document.myform.' + op_name);
  var code  = field.value;
  var n     = combo.options.length;
  for ( var i=0; i<n; i++ )
  {
    if ( combo.options[i].value == code )
    {
      combo.selectedIndex = i;
      return;
    }
  }

  alert(code + ' não é um código válido!');

  field.focus();

  return true;
}

function buscaDisciplina()
{
  tipo_busca = 1;
  
  var ref_periodo = document.myform.ref_periodo.value;

  if ( ref_periodo == '' )
  {
    alert("Código do período inválido ou não especificado!");
    return;
  }

  var url = "../generico/post/lista_disciplinas_ofer.php3" +
            "?ref_periodo=" + escape(ref_periodo) +
            "&desc=" + document.myform.descricao_disciplina.value;

  var wnd = window.open(url,'busca','toolbar=no,width=550,height=350,scrollbars=yes');
}

function buscaPessoa()
{
  tipo_busca = 2;

  var url = "/generico/post/lista_pessoas.php3" +
            "?pnome=" + escape(document.myform.pessoa.value);

  var wnd = window.open(url,'busca','toolbar=no,width=530,height=350,scrollbars=yes');
}

function setResult(arg1, arg2, arg3)
{
    if (tipo_busca == 1)
    {
        document.myform.ref_disciplina_ofer.value = arg1;
        document.myform.descricao_disciplina.value = arg2;
        document.myform.ref_disciplina_ofer_compl.value = arg3;
    }
    else
    {
        document.myform.ref_pessoa.value = arg1;
        document.myform.pessoa.value = arg2;
    }
}

</script>
</head>
<body bgcolor="#FFFFFF" marginwidth="20" marginheight="20">
<form method="post" action="post/lideres_inclui.php3" name="myform">
  <table width="90%" align="center">
    <tr> 
      <td bgcolor="#000099" colspan="2" height="28" align="center"> 
      <font size="3" face="Verdana, Arial, Helvetica, sans-serif" color="#CCCCFF"><b>Inclusão de Líderes de Turma</b></font></td>
    </tr>
    <tr> 
      <td bgcolor="#CCCCFF" width="20%"><font face="Verdana, Arial, Helvetica, sans-serif" size="2" color="#00009C">&nbsp;Per&iacute;odo 
        </font>
      </td>
      <td width="80%"> 
        <input name="ref_periodo" type=text size="7" onChange="ChangeCode('ref_periodo','op1')" value="<?echo($ref_periodo)?>">
        <font color="#000000"> 
        <script language="PHP">ComboArray("op1",$op1_opcoes,$ref_periodo,"ChangeOp1()");</script>
        </font>
      </td>
    </tr>

    <tr>
      <td bgcolor="#CCCCFF" width="30%"><font face="Verdana, Arial, Helvetica, sans-serif" size="2" color="#00009C">&nbsp;Código da Disciplina Oferecida&nbsp;</font></td>
      <td width="70%">
       <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
         <td>
            <input type=text name="ref_disciplina_ofer" size="7" maxlength="10">
            <input type="text" name="descricao_disciplina" size="30">
         </td>
         <td>
         <div align="right">
            <input type="button" value="..." onClick="buscaDisciplina()" name="button22"></div>
         </td>
        </tr>
       </table>
      </td>
    </tr>
    <tr> 
      <td bgcolor="#CCCCFF"><font face="Verdana, Arial, Helvetica, sans-serif" size="2" color="#00009C">&nbsp;Código da Disciplina Oferecida Compl</font></td>
      <td> 
        <input name="ref_disciplina_ofer_compl" type=text size="7">
      </td>
    </tr>
    <tr>
      <td bgcolor="#CCCCFF" width="30%"><font face="Verdana, Arial, Helvetica, sans-serif" size="2" color="#00009C">&nbsp;Aluno&nbsp;</font></td>
      <td width="70%">
       <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
         <td>
            <input type=text name="ref_pessoa" size="7" maxlength="10">
            <input type="text" name="pessoa" size="30">
         </td>
         <td>
         <div align="right">
            <input type="button" value="..." onClick="buscaPessoa()" name="button2"></div>
         </td>
        </tr>
       </table>
      </td>
    </tr>

    <tr> 
      <td colspan="2"> 
        <hr size="1">
      </td>
    </tr>
    <tr> 
      <td colspan="2" align="center"> 
        <input type="submit" name="Submit"  value=" Salvar ">
        <input type="reset" name="Submit2"  value=" Limpar ">
        <input type="button" name="Button2" value=" Voltar " onClick="location='consulta_inclui_lideres.phtml'">
      </td>
    </tr>
  </table>
  </form>
  </body>
</html>
